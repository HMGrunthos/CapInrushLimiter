Version 4
SHEET 1 2944 968
WIRE -928 -544 -992 -544
WIRE -992 -528 -992 -544
WIRE -880 -528 -880 -608
WIRE -928 -512 -928 -544
WIRE -992 -432 -992 -448
WIRE -960 -432 -992 -432
WIRE -928 -432 -928 -464
WIRE -928 -432 -960 -432
WIRE -960 -400 -960 -432
WIRE -880 -368 -880 -448
WIRE -1536 -256 -1536 -288
WIRE -1520 -256 -1536 -256
WIRE -1456 -256 -1456 -288
WIRE -1456 -256 -1520 -256
WIRE -1520 -192 -1520 -256
WIRE -1472 -192 -1520 -192
WIRE -1360 -192 -1360 -256
WIRE -1360 -192 -1392 -192
WIRE -1328 -192 -1360 -192
WIRE -1200 -192 -1264 -192
WIRE -1024 -192 -1200 -192
WIRE -928 -192 -1024 -192
WIRE -832 -192 -928 -192
WIRE -704 -192 -736 -192
WIRE -432 -192 -432 -256
WIRE -432 -192 -704 -192
WIRE -288 -192 -432 -192
WIRE -144 -192 -288 -192
WIRE -48 -192 -144 -192
WIRE 48 -192 -48 -192
WIRE -1792 -176 -1872 -176
WIRE -1664 -176 -1728 -176
WIRE -928 -160 -928 -192
WIRE -288 -160 -288 -192
WIRE -1024 -144 -1024 -192
WIRE -2112 -96 -2176 -96
WIRE -1872 -96 -1872 -176
WIRE -1872 -96 -2032 -96
WIRE -1792 -96 -1872 -96
WIRE -1664 -96 -1664 -176
WIRE -1664 -96 -1728 -96
WIRE -1520 -96 -1520 -192
WIRE -1520 -96 -1664 -96
WIRE -416 -80 -480 -80
WIRE -288 -80 -288 -96
WIRE -288 -80 -352 -80
WIRE -2176 -32 -2176 -96
WIRE -1872 -32 -1872 -96
WIRE -1792 -32 -1872 -32
WIRE -1632 -32 -1728 -32
WIRE -288 -32 -288 -80
WIRE -1520 -16 -1520 -96
WIRE -1024 -16 -1024 -80
WIRE -928 -16 -928 -80
WIRE -928 -16 -1024 -16
WIRE -864 -16 -928 -16
WIRE -816 -16 -816 -144
WIRE -816 -16 -864 -16
WIRE -624 -16 -816 -16
WIRE -576 -16 -576 -64
WIRE -576 -16 -624 -16
WIRE -528 -16 -576 -16
WIRE -480 -16 -480 -80
WIRE -480 -16 -528 -16
WIRE -336 -16 -480 -16
WIRE -1792 32 -1840 32
WIRE -1664 32 -1664 -96
WIRE -1664 32 -1728 32
WIRE -624 32 -624 -16
WIRE -528 48 -528 -16
WIRE -1200 80 -1200 -192
WIRE -144 80 -144 -192
WIRE -48 80 -48 -192
WIRE 48 80 48 -192
WIRE -2176 96 -2176 48
WIRE -2112 96 -2176 96
WIRE -1840 96 -1840 32
WIRE -1840 96 -2032 96
WIRE -1792 96 -1840 96
WIRE -1632 96 -1632 -32
WIRE -1632 96 -1728 96
WIRE -1520 96 -1520 48
WIRE -1520 96 -1632 96
WIRE -288 112 -288 64
WIRE -624 160 -624 112
WIRE -528 160 -528 112
WIRE -528 160 -624 160
WIRE -480 160 -528 160
WIRE -864 176 -864 -16
WIRE -624 192 -624 160
WIRE -1200 224 -1200 160
WIRE -1136 224 -1200 224
WIRE -1008 224 -1056 224
WIRE -928 224 -1008 224
WIRE -512 240 -560 240
WIRE -464 240 -512 240
WIRE -416 240 -464 240
WIRE -288 240 -288 192
WIRE -288 240 -352 240
WIRE -224 240 -288 240
WIRE -2112 272 -2176 272
WIRE -1872 272 -2032 272
WIRE -1792 272 -1872 272
WIRE -1664 272 -1728 272
WIRE -1520 272 -1520 96
WIRE -1520 272 -1664 272
WIRE -1008 304 -1008 224
WIRE -864 304 -864 272
WIRE -816 304 -864 304
WIRE -704 304 -704 -192
WIRE -704 304 -752 304
WIRE -1200 320 -1200 224
WIRE -512 320 -512 240
WIRE -464 320 -464 240
WIRE -288 320 -288 240
WIRE -224 320 -224 240
WIRE -2176 336 -2176 272
WIRE -1872 336 -1872 272
WIRE -1792 336 -1872 336
WIRE -1632 336 -1728 336
WIRE -864 336 -864 304
WIRE -624 336 -624 288
WIRE -1520 352 -1520 272
WIRE -1792 400 -1840 400
WIRE -1664 400 -1664 272
WIRE -1664 400 -1728 400
WIRE -2176 464 -2176 416
WIRE -2112 464 -2176 464
WIRE -1840 464 -1840 400
WIRE -1840 464 -2032 464
WIRE -1792 464 -1840 464
WIRE -1632 464 -1632 336
WIRE -1632 464 -1728 464
WIRE -1520 464 -1520 416
WIRE -1520 464 -1632 464
WIRE -1200 464 -1200 400
WIRE -1200 464 -1520 464
WIRE -1008 464 -1008 368
WIRE -1008 464 -1200 464
WIRE -864 464 -864 416
WIRE -864 464 -1008 464
WIRE -624 464 -624 416
WIRE -624 464 -864 464
WIRE -512 464 -512 384
WIRE -512 464 -624 464
WIRE -464 464 -464 384
WIRE -464 464 -512 464
WIRE -288 464 -288 384
WIRE -288 464 -464 464
WIRE -224 464 -224 400
WIRE -224 464 -288 464
WIRE -144 464 -144 144
WIRE -144 464 -224 464
WIRE -48 464 -48 160
WIRE -48 464 -144 464
WIRE 48 464 48 160
WIRE 48 464 -48 464
WIRE -1520 496 -1520 464
FLAG -1520 496 0
FLAG -880 -608 T
FLAG -880 -368 S
FLAG -1360 -256 T
FLAG -432 -256 S
FLAG -960 -400 0
FLAG -576 -64 RCA
FLAG -480 160 RCB
SYMBOL voltage -2176 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value SINE(0 37.7736 50 0 0 0 2000)
SYMBOL schottky -1792 -80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1728 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1792 48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D7
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1728 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -2016 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 0.0855
SYMBOL schottky -1792 288 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1728 448 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D10
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1792 416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D11
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky -1728 320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D12
SYMATTR Value RB238NS150
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -2016 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 0.0855
SYMBOL voltage -2176 320 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 37.7736 50 0 0 0 2000)
SYMBOL res -2016 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 0.0855
SYMBOL res -2016 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 0.0855
SYMBOL cap -1728 -192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 100nF
SYMATTR SpiceLine V=60
SYMBOL cap -1536 352 R0
SYMATTR InstName C2
SYMATTR Value 13200µF
SYMATTR SpiceLine V=50 Rser=0.03
SYMBOL cap -1536 -16 R0
SYMATTR InstName C3
SYMATTR Value 13200µF
SYMATTR SpiceLine V=50 Rser=0.03
SYMBOL pmos -736 -144 M270
SYMATTR InstName M1
SYMATTR Value irf9540npbf
SYMATTR Prefix X
SYMBOL cap -160 80 R0
WINDOW 0 -1 -22 VRight 2
WINDOW 3 -1 46 VRight 2
SYMATTR InstName C10
SYMATTR Value 16200µF
SYMATTR SpiceLine V=80 Rser=0.016
SYMBOL res -1216 304 R0
SYMATTR InstName R8
SYMATTR Value 2.2e3
SYMBOL pmos -336 64 M180
SYMATTR InstName M4
SYMATTR Value BSP230
SYMATTR Prefix X
SYMBOL res -1184 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 100e3
SYMBOL cap -1024 304 R0
WINDOW 0 25 55 Left 2
WINDOW 3 25 5 Left 2
SYMATTR InstName C11
SYMATTR Value 220e-9
SYMBOL npn -928 176 R0
SYMATTR InstName Q2
SYMATTR Value KST42
SYMBOL res -848 432 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 2.2e3
SYMBOL res -944 -64 M180
WINDOW 0 29 8 Left 2
WINDOW 3 30 47 Left 2
SYMATTR InstName R17
SYMATTR Value 100e3
SYMBOL cap -752 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C12
SYMATTR Value 10e-6
SYMBOL res -1440 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 54 VTop 2
SYMATTR InstName R20
SYMATTR Value R=if((time<0.1)|((time > 3)&(time<6)),1e9,1e-6)
SYMBOL diode -1328 -176 R270
WINDOW 0 -32 32 VTop 2
WINDOW 3 63 34 VBottom 2
SYMATTR InstName D1
SYMATTR Value UF5406
SYMBOL sw -880 -432 M180
WINDOW 3 12 101 Left 2
SYMATTR Value Relay
SYMATTR InstName S1
SYMBOL bv -992 -544 R0
WINDOW 0 -22 -13 VRight 2
WINDOW 3 -54 -32 VRight 2
SYMATTR InstName B1
SYMATTR Value V=V(RCA,RCB)
SYMBOL res -1040 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100e3
SYMBOL diode -304 -160 R0
WINDOW 3 40 36 Left 2
SYMATTR Value BAS16H
SYMATTR InstName D5
SYMBOL res -1376 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 54 VTop 2
SYMATTR InstName R1
SYMATTR Value R=if(time<0.1,1e9,1e-6)
SYMBOL current -48 80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 80 Invisible 2
SYMATTR Value PWL(0 0 1.5 0 5 7)
SYMATTR InstName I1
SYMBOL diode -512 112 R180
WINDOW 0 -32 3 Left 2
WINDOW 3 -72 60 Left 2
SYMATTR InstName D3
SYMATTR Value 1N4001
SYMBOL ind -640 16 R0
SYMATTR InstName L2
SYMATTR Value 1e-6
SYMATTR SpiceLine Rser=5760
SYMBOL zener -416 256 R270
WINDOW 0 36 32 VTop 2
WINDOW 3 -4 32 VBottom 2
SYMATTR InstName D19
SYMATTR Value BZX84C15L
SYMBOL cap -272 320 M0
WINDOW 3 0 58 Left 2
SYMATTR Value 10e-6
SYMATTR InstName C7
SYMBOL res -304 96 R0
SYMATTR InstName R9
SYMATTR Value 100e3
SYMBOL res 32 64 R0
SYMATTR InstName R10
SYMATTR Value 8.3e3
SYMBOL res -240 304 R0
SYMATTR InstName R12
SYMATTR Value 1e6
SYMBOL LED -480 320 R0
SYMATTR InstName D21
SYMATTR Value REDLED
SYMBOL zener -416 -64 R270
WINDOW 0 36 32 VTop 2
WINDOW 3 -4 32 VBottom 2
SYMATTR InstName D14
SYMATTR Value mm3z12vt1g
SYMATTR Prefix X
SYMBOL zener -1008 -80 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D15
SYMATTR Value mm3z12vt1g
SYMATTR Prefix X
SYMBOL cap -496 320 M0
WINDOW 0 25 11 Left 2
WINDOW 3 25 51 Left 2
SYMATTR InstName C5
SYMATTR Value 100e-9
SYMBOL npn -560 192 M0
SYMATTR InstName Q3
SYMATTR Value KST42
SYMBOL res -608 320 M0
SYMATTR InstName R3
SYMATTR Value 96
TEXT -2176 -184 Left 2 !.tran 8 startup
TEXT -2176 672 Left 2 !.model UF5406 d(is = 1.15563E-005 n = 3.45 rs = 0.0887337 eg = 1.11 xti = 3 cjo = 9.14327E-011 vj = 0.298558 m = 0.347605 fc = 0.5  tt = 1.57227E-007 bv = 660 ibv = 0.3 af = 1 kf = 0)
TEXT -2176 544 Left 2 !.inc Infineon-Spice-File-IRF9540NPBF-SM-v01_00-EN.spi
TEXT -2176 -152 Left 2 !.options cshunt=1e-15
TEXT -2176 704 Left 2 !.inc BAS16H.txt
TEXT -2176 576 Left 2 !.inc BSP230.prm
TEXT -2176 640 Left 2 !.model 1N4001 D(Is=14.11n N=1.984 Rs=33.89m Ikf=94.81 Xti=3 Eg=1.11 Cjo=25.89p M=.44 Vj=.3245 Fc=.5 Bv=75 Ibv=10u Tt=5.7u Iave=1 Vpk=50 mfg=GI type=silicon
TEXT -800 -488 Left 2 !.model Relay SW(Roff=1Meg Ron=1e-3 Vt=34V Vh=2)
TEXT -2176 608 Left 2 !.lib KST42.lib
TEXT -2176 768 Left 2 !.MODEL REDLED D (IS=93.2P RS=42M N=3.73 BV=4 IBV=10U CJO=2.97P VJ=.75 M=.333 TT=4.32U)
TEXT -2176 736 Left 2 !.lib MM3Z12VT1G.LIB
